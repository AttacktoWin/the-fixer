[gd_scene load_steps=18 format=2]

[ext_resource path="res://Assets/UI/Buttons/button-newgame-hover.png" type="Texture" id=1]
[ext_resource path="res://Assets/UI/Buttons/button-resume.png" type="Texture" id=2]
[ext_resource path="res://Assets/UI/Buttons/button-newgame.png" type="Texture" id=3]
[ext_resource path="res://Assets/UI/Buttons/button-resume-hover.png" type="Texture" id=4]
[ext_resource path="res://Assets/UI/Buttons/button-quitgame-hover.png" type="Texture" id=5]
[ext_resource path="res://Assets/UI/Buttons/button-quitgame.png" type="Texture" id=6]
[ext_resource path="res://Scripts/Level/Level.gd" type="Script" id=7]
[ext_resource path="res://Assets/UI/MainLoop.ogv" type="VideoStream" id=8]
[ext_resource path="res://Assets/UI/title.png" type="Texture" id=9]
[ext_resource path="res://Scenes/Interface/Menus/UpgradePopUp.tscn" type="PackedScene" id=10]
[ext_resource path="res://Assets/UI/logo.png" type="Texture" id=11]

[sub_resource type="GDScript" id=3]
resource_name = "Video"
script/source = "extends VideoPlayer


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"


# Called when the node enters the scene tree for the first time.
func _ready():
	connect(\"finished\",self,\"loop\")

func loop():
	self.play()
"

[sub_resource type="GDScript" id=4]
script/source = "extends VBoxContainer


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"


# Called when the node enters the scene tree for the first time.
func _ready():
	check_save()

func check_save():
	var resume = get_node(\"Resume\")
	var new_game = get_node(\"NewGame\")
	if SaveHelper.has_save_file():
		
		new_game.visible=false
		resume.visible=true
		resume.grab_focus()
	else:
		new_game.visible=true
		resume.visible=false
		new_game.grab_focus()

# Called every frame. 'delta' is the elapsed time since the previous frame.
#func _process(delta):
#	pass
"

[sub_resource type="GDScript" id=1]
resource_name = "StartGame"
script/source = "extends TextureButton

const TUTORIAL = preload(\"res://Scenes/Levels/Tutorial.tscn\")

func start_game():
	Scene.switch(TUTORIAL.instance())


func _ready():
	connect(\"mouse_entered\", self, \"_on_mouse_entered\")

func _process(_delta):
	if not self.is_visible_in_tree() or not Scene.is_controller():
		return
	var focus_owner = get_focus_owner()
	if focus_owner == null or not focus_owner.is_inside_tree() or not focus_owner.is_visible_in_tree():
		self.grab_focus()

func _on_mouse_entered():
	var owner = get_focus_owner()
	if owner:
		owner.release_focus()
	self.grab_focus()
"

[sub_resource type="GDScript" id=5]
script/source = "extends TextureButton


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"


func _ready():
	connect(\"mouse_entered\", self, \"_on_mouse_entered\")

func _process(_delta):
	if not self.is_visible_in_tree() or not Scene.is_controller():
		return
	var focus_owner = get_focus_owner()
	if focus_owner == null or not focus_owner.is_inside_tree() or not focus_owner.is_visible_in_tree():
		self.grab_focus()

func _on_mouse_entered():
	var owner = get_focus_owner()
	if owner:
		owner.release_focus()
	self.grab_focus()

func start_game():
	SaveHelper.load_game()
"

[sub_resource type="GDScript" id=6]
resource_name = "quit"
script/source = "extends TextureButton

func _on_Quit_pressed():
	Scene.get_tree().quit()

func _ready():
	connect(\"mouse_entered\", self, \"_on_mouse_entered\")

func _on_mouse_entered():
	var owner = get_focus_owner()
	if owner:
		owner.release_focus()
	self.grab_focus()
"

[sub_resource type="GDScript" id=7]
script/source = "extends Control

var _timer = 0;

func _process(delta):

	if Input.is_action_pressed(\"delete_save\"):
		self._timer += delta
		if self._timer > 1.5:
			SaveHelper.delete()
			self._timer = -1e9
			get_parent().get_node(\"HBoxContainer/New_Cont\").check_save()
	else:
		self._timer = 0
"

[node name="Level" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = ExtResource( 7 )
is_ui = true
ui_enabled = false
vision_enabled = false
level_index = -3
level_music = 309205993

[node name="VideoPlayer" type="VideoPlayer" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
margin_top = 63.0
margin_right = -234.0
margin_bottom = -69.0
stream = ExtResource( 8 )
autoplay = true
script = SubResource( 3 )

[node name="Title" type="Sprite" parent="."]
position = Vector2( 1528, 311 )
texture = ExtResource( 9 )

[node name="HBoxContainer" type="VBoxContainer" parent="."]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = 340.0
margin_top = 11.0
margin_right = 1344.0
margin_bottom = 469.0

[node name="New_Cont" type="VBoxContainer" parent="HBoxContainer"]
margin_right = 1004.0
margin_bottom = 304.0
script = SubResource( 4 )

[node name="NewGame" type="TextureButton" parent="HBoxContainer/New_Cont"]
margin_right = 1004.0
margin_bottom = 150.0
texture_normal = ExtResource( 3 )
texture_hover = ExtResource( 1 )
texture_focused = ExtResource( 1 )
script = SubResource( 1 )

[node name="Resume" type="TextureButton" parent="HBoxContainer/New_Cont"]
visible = false
margin_top = 154.0
margin_right = 1004.0
margin_bottom = 304.0
texture_normal = ExtResource( 2 )
texture_hover = ExtResource( 4 )
texture_focused = ExtResource( 4 )
script = SubResource( 5 )

[node name="Quit" type="TextureButton" parent="HBoxContainer/New_Cont"]
margin_top = 154.0
margin_right = 1004.0
margin_bottom = 304.0
texture_normal = ExtResource( 6 )
texture_hover = ExtResource( 5 )
texture_focused = ExtResource( 5 )
script = SubResource( 6 )

[node name="Logo" type="Sprite" parent="."]
position = Vector2( 141, 1014 )
scale = Vector2( 0.4, 0.4 )
texture = ExtResource( 11 )

[node name="UpdatePopUp" parent="." instance=ExtResource( 10 )]
visible = false

[node name="SaveDeleter" type="Control" parent="."]
margin_right = 40.0
margin_bottom = 40.0
script = SubResource( 7 )

[connection signal="button_down" from="HBoxContainer/New_Cont/NewGame" to="HBoxContainer/New_Cont/NewGame" method="start_game"]
[connection signal="button_down" from="HBoxContainer/New_Cont/Resume" to="HBoxContainer/New_Cont/Resume" method="start_game"]
[connection signal="pressed" from="HBoxContainer/New_Cont/Quit" to="HBoxContainer/New_Cont/Quit" method="_on_Quit_pressed"]
